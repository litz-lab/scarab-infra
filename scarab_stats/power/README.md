# ğŸ§© McPATâ€“Scarab Format Converter

This utility provides a lightweight Python interface to bridge Scarab simulation outputs and McPAT power modeling inputs.
It automates the conversion pipeline between Scarabâ€™s parameter/statistics files and McPATâ€™s XML format.

---

## ğŸ“ Structure

```
.
â”œâ”€â”€ converter.py          # Core conversion logic (Converter class)
â”œâ”€â”€ client.py             # Command-line interface for using Converter
â”œâ”€â”€ xml/
â”‚   â”œâ”€â”€ template.xml      # McPAT XML template
â”‚   â””â”€â”€ mcpat_infile.xml  # Generated final XML (Converter output)
â”œâ”€â”€ json/                 # Generated JSON intermediate files
â”‚   â”œâ”€â”€ params_table.json
â”‚   â”œâ”€â”€ stats_table.json
â”‚   â””â”€â”€ mcpat_structure.json
â”œâ”€â”€ scarab_output/        # Scarab simulation output (Converter input)
â”‚   â”œâ”€â”€ PARAMS.out        # Scarab simulation architecture parameters
â”‚   â””â”€â”€ power.pkl         # Scarab simulation runtime power statistics
â””â”€â”€ mcpat
```

---

## ğŸš€ Usage

The main entry point of the workflow is client.py, which provides subcommands for each stage of the McPATâ€“Scarab conversion process. You can either execute the entire pipeline in a single command or run each step individually for finer control. To generate the final McPAT XML input in one go, simply run:
```
python client.py all
```

### 1ï¸âƒ£ Generate initial JSON files from McPAT XML template
```
python client.py generate-json
```
 - input: ./xml/template.xml
 - output: ./json/

The input to this step is a sample McPAT XML template that defines the hierarchical organization and parameters of the modeled architecture. When the generate-json command is executed, the tool parses this XML and generates three JSON files: mcpat_structure.json, which captures the hierarchical tree structure of the XML; params_table.json, which stores the static architectural parameters describing the configuration properties; and stats_table.json, which represents the dynamic power-related data collected from simulation.

### 2ï¸âƒ£ Update JSON with Scarab PARAMS file
```
python client.py update-params
```
 - input: ./scarab_output/PARAMS.out
 - output: ./json/params_table.json

This step uses the PARAMS.out file generated by Scarab to update and adjust the corresponding values in params_table.json.

### 3ï¸âƒ£ Update JSON with Scarab STATS file
```
python client.py update-stats
```
 - input: ./scarab_output/power.pkl
 - output: ./json/stats_table.json

This step updates the dynamic power statistics in ./json/stats_table.json using a dictionary of runtime data. This dictionary should be manually generated after running the Scarab simulation and should contain the relevant power-related metrics, which are then written into the corresponding fields of the JSON file.

### 4ï¸âƒ£ Generate final McPAT XML file
```
python client.py generate-xml
```
 - input: ./json
 - output: ./xml/mcpat_infile.xml

This step combines the data from the parameter table and the statistics table according to the predefined hierarchical structure, and regenerates the complete McPAT XML input file. The resulting XML serves as the finalized input for McPATâ€™s power, area, and timing analysis.

---

## ğŸš€ McPAT Launch

After the final step, you can run McPAT manually:

```
./mcpat -dump_design -infile xml/mcpat_infile.xml -print_level 5 > scarab.out
```